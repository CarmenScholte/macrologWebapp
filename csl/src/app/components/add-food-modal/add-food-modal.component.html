<div class="modal">
  <div class="modal__header">
    <h3 class="modal__header__title">{{title}}</h3>

    <button class="button button--icon button--primary" (click)="closeModal()">
      <i class="fas fa-times"></i>
    </button>

  </div>

  <div class="modal__content">

    <p>When it's more logical to measure in whole units, fill in the nutrients
      <strong class="strong--signal">per unit</strong>. Like with an egg or other food you can't easily make portions of.
      We recommend you weigh the unit, although this is optional.
    </p>

    <form #addFoodForm="ngForm">
      <div class="form-field">
        <div class="form-field__element">
          <label class="form-field__label">Food</label>
          <input [(ngModel)]="name" #foodField name="name" class="form-field__text" placeholder="e.g. 'Pasta', 'Apple'" required>
        </div>
      </div>

      <div class="form-field">
        <div class="form-field__element">
          <div class="radio-group">
            <label class="form-field__label">Nutrients</label>
            <input class="form-field__radio" type="radio" name="measurementUnit"
                   [(ngModel)]="measurementUnit" value="grams"
                   [ngClass]="{'form-field__radio--checked fas fa-check': measurementUnit === 'grams' }" required>
            <span class="radio__label">per 100gr</span>
            <input class="form-field__radio" type="radio" name="measurementUnit"
                   [(ngModel)]="measurementUnit" value="unit"
                   [ngClass]="{'form-field__radio--checked fas fa-check': measurementUnit === 'unit' }">
            <span class="radio__label">per unit</span>
          </div>
        </div>
      </div>

      <ng-container *ngIf="measurementUnit === 'unit'">
        <div class="form-field">
          <div class="form-field__element">
            <label class="form-field__label">Unit name</label>
            <input class="form-field__text" #unitNameField [(ngModel)]="unitName" name="unitName" placeholder="e.g. 'Piece', 'Slice'">
          </div>
        </div>
        <div class="form-field">
          <div class="form-field__element">
            <label class="form-field__label">Grams</label>
            <input class="form-field__text" #gramsField [(ngModel)]="unitGrams" name="grams" placeholder="Optional" type="number">
          </div>
        </div>
      </ng-container>

      <div class="form-field form-field--column">
        <div class="form-field__element form-field__element--column">
          <label class="form-field__label">Protein</label>
          <input class="form-field__text" #proteinField [(ngModel)]="protein"
                 value="protein"
                 name="protein" type="number" placeholder="0,0" step="0.1" required>
        </div>
        <div class="form-field__element form-field__element--column">
          <label class="form-field__label">Fat</label>
          <input class="form-field__text" #fatField [(ngModel)]="fat"
                 name="fat" type="number" placeholder="0,0" step="0.1" required>
        </div>
        <div class="form-field__element form-field__element--column">
          <label class="form-field__label">Carbs</label>
          <input class="form-field__text" #carbsField [(ngModel)]="carbs"
                 name="carbs" type="number" placeholder="0,0" step="0.1" required>
        </div>
      </div>

      <label class="modal__label">Frequently used portions (optional)</label>

      <div class="modal__portions" *ngFor="let port of portions; index as i">
        <div class="form-field form-field--column">
          <div class="form-field__element form-field__element--column" *ngIf="measurementUnit === 'grams'">
            <label class="form-field__label">Grams</label>
            <input class="form-field__text" [(ngModel)]="port.grams" placeholder="0,0"
                   name="portionGrams_{{i}}" type="number" step="1" required>
          </div>

          <div class="form-field__element form-field__element--column" *ngIf="measurementUnit === 'unit'">
            <label class="form-field__label">{{unitName === '' ? 'Portion' : unitName}}</label>
            <input class="form-field__text" [(ngModel)]="port.unit"
                   name="portionUnit_{{i}}" value="port.unit" type="number"
                   placeholder="0,0" step="0.1" required>
          </div>

          <div class="form-field__element form-field__element--column">
            <label class="form-field__label">Description</label>
            <input class="form-field__text" [(ngModel)]="port.description"
                   name="portionDesc_{{i}}" type="text"
                   placeholder="e.g. 'Breakfast', 'Plate'" required>
          </div>

          <div class="form-field__element form-field__element--column form-field__element--end">
            <button class="button button--transparent" (click)="removePortion(i)">
              <i class="fas fa-minus"></i>
            </button>
          </div>
        </div>
      </div>

      <button class="button button--transparent" (click)="newPortion()">
        <i class="fas fa-plus"></i>
      </button>

      <div class="modal__button-wrapper">
        <button type="button" class="button button--primary" (click)="addFood()"
            [disabled]="addFoodForm.invalid">Done</button>
      </div>

    </form>

  </div>

</div>
